#include<stdio.h>

#include"EEA3_128.h"
int main() {
	
	Byte key[16] = { 0x17 ,0x3d ,0x14 ,0xba ,0x50 ,0x03 ,0x73 ,0x1d ,0x7a ,0x60 ,0x04 ,0x94 ,0x70 ,0xf0 ,0x0a ,0x29 };
	unsigned int count = 0x66035492;
	unsigned int bearer = 0xf;
	bool direction = false;
	//官方测试数据1后添加了0xff，测试非4整数倍
	unsigned int length = 25;
	Byte P[25] = { 0x6c,0xf6,0x53,0x40,0x73,0x55,0x52,0xab ,0x0c,0x97,0x52,0xfa ,
		           0x6f,0x90,0x25,0xfe,0x0b,0xd6,0x75,0xd9 ,0x00,0x58,0x75,0xb2 ,0xff};
	Byte C[25], M[25];
	EEA3_INIT(count,bearer,key,direction,0.5,NULL,DEFAULT);
	EEA3(P,length, C);
	EEA3_clear();
	EEA3_INIT(count, bearer, key, direction, 0.5, NULL, DEFAULT);
	DeEEA3(C,length,M);
	return 0;
}


/*  zuc官方测试测试数据
#include"zuckey.h"
int main() {
	ZUC_DATA data = { {0},{0},{0},{0} };
	//Byte k[16] = {0};
	//Byte iv[16] = { 0 };
	//Byte k[16] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
	//Byte iv[16] = { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff};
	//Byte k[16] = {0x3d,0x4c,0x4b,0xe9,0x6a,0x82,0xfd,0xae,0xb5,0x8f,0x64,0x1d,0xb1,0x7b,0x45,0x5b};
	//Byte iv[16] = {0x84,0x31,0x9a,0xa8,0xde,0x69,0x15,0xca,0x1f,0x6b,0xda,0x6b,0xfb,0xd8,0xc7,0x66 };
Byte k[16] = { 0x4d,0x32,0x0b,0xfa,0xd4,0xc2,0x85,0xbf,0xd6,0xb8,0xbd,0x00,0xf3,0x9d,0x8b,0x41 };
Byte iv[16] = { 0x52,0x95,0x9d,0xab,0xa0,0xbf,0x17,0x6e,0xce,0x2d,0xc3,0x15,0x04,0x9e,0xb5,0x74 };
zuc_loadKey(&data, k, iv);
int z1 = zuc_getKey(&data);
int z2 = zuc_getKey(&data);
return 0;
}
*/
